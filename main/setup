#!QOpenSys/usr/bin/sh
export TGTLIB=OSSILE
if [ ! -e /qsys.lib/ossile.lib ] ; then
  system "crtlib $TGTLIB"
fi
export WORKDIR=$(pwd)/$(dirname $0)

ITEMS=$(tr '\n' ' ' < $WORKDIR/buildlist.txt)

export FAILURE_ITEMS=""
export SUCCESS_ITEMS=""


for ITEM in $ITEMS
do
 cd $WORKDIR/$ITEM && setup
 if [ $? -eq 0 ] ; then
  echo item $ITEM built successfully
  SUCCESS_ITEMS="$SUCCESS_ITEMS $ITEM"
 else
  echo item $ITEM failed to build
  FAILURE_ITEMS="$FAILURE_ITEMS $ITEM"
 fi
done
echo " "
echo "========================================"
echo " "
echo " "
echo "The following has built successfully:"
for ITEM in $SUCCESS_ITEMS
do
 echo "   $ITEM"
done
if [ "$FAILURE_ITEMS" == "" ] ; then
 echo " "
 echo "No failures"
 echo " "
 exit 0
fi

echo " "
echo " "
echo "The following has failed to build:"
for ITEM in $FAILURE_ITEMS
do
 echo "   $ITEM"
done
echo " "
exit 5